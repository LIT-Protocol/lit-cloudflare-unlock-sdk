function dataURItoBlob(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(e.length),i=new Uint8Array(a),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return new Blob([a],{type:n})}async function onClickedUnlock(t){var e=JSON.parse(atob(t.getAttribute("data-lit")));const n=JSON.parse(atob(e.accessControlConditions)),a=dataURItoBlob(e.encryptedZip),i=buf2hex(new Uint8Array(atob(e.encryptedSymmetricKey).split(",").map((t=>parseInt(t))))),o=n[0].chain,c=await LitJsSdk.checkAndSignAuthMessage({chain:o}),r=await window.litNodeClient.getEncryptionKey({accessControlConditions:n,toDecrypt:i,chain:o,authSig:c}),s=await LitJsSdk.decryptZip(a,r),d=await s["string.txt"].async("text");if(null!=d&""!=d){console.log("Unlocked");const e=`https://iframe.videodelivery.net/${d}`;t.src=e,t.parentElement.classList.add("active")}}async function onClickedUnlockJWT(t){const e=JSON.parse(atob(t.getAttribute("data-lit"))),n=JSON.parse(atob(e.accessControlConditions)),a=JSON.parse(atob(e.resourceId_base64));console.log(a);const i=n[0].chain,o=await LitJsSdk.checkAndSignAuthMessage({chain:i}),c=await litNodeClient.getSignedToken({accessControlConditions:n,chain:i,authSig:o,resourceId:a});console.warn("JWT:",c)}buf2hex=t=>[...new Uint8Array(t)].map((t=>t.toString(16).padStart(2,"0"))).join(""),[...document.getElementsByClassName("lit-video-wrapper")].forEach((t=>{var e=t.querySelector("iframe"),n=t.querySelector("button"),a=e.getAttribute("data-readable-conditions"),i=document.createElement("div");i.classList.add("lit-video-description");var o=document.createElement("div");o.classList.add("lit-video-overlay");var c=document.createElement("span");c.classList.add("lit-video-info"),c.innerText=a,t.insertBefore(o,e),t.appendChild(i),i.appendChild(n),i.appendChild(c),n.addEventListener("click",(()=>onClickedUnlockJWT(e))),t.addEventListener("click",(()=>onClickedUnlockJWT(e)))}));
