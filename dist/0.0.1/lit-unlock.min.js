function dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),i=new Uint8Array(n),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([n],{type:a})}async function onClickedUnlock(e){const t=JSON.parse(atob(e.getAttribute("data-lit"))),a=JSON.parse(atob(t.accessControlConditions)),n=JSON.parse(atob(t.resourceId_base64));console.log(`ðŸ”“resourceId: ${JSON.stringify(n)}`);const i=a[0].chain,r=await LitJsSdk.checkAndSignAuthMessage({chain:i}),o=e.getAttribute("data-server");console.log(`ðŸ”“ SERVER: ${o}`);const s=`${o}/api/video_id?jwt=${await litNodeClient.getSignedToken({accessControlConditions:a,chain:i,authSig:r,resourceId:n})}`;console.warn(s);const d=await fetch(s),l=await d.json();e.src=`https://iframe.videodelivery.net/${l}`,e.parentElement.classList.add("active")}function manipulateWrapper(e){var t=e.querySelector("iframe"),a=e.querySelector("button"),n=t.getAttribute("data-readable-conditions"),i=document.createElement("div");i.classList.add("lit-video-description");var r=document.createElement("div");r.classList.add("lit-video-overlay");var o=document.createElement("span");if(o.classList.add("lit-video-info"),o.innerText=n,e.insertBefore(r,t),e.appendChild(i),i.appendChild(a),i.appendChild(o),"live"==JSON.parse(atob(JSON.parse(atob(t.getAttribute("data-lit"))).resourceId_base64)).extraData){var s=document.createElement("div");s.classList.add("lit-video-live"),s.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728m-9.9-2.829a5 5 0 010-7.07m7.072 0a5 5 0 010 7.07M13 12a1 1 0 11-2 0 1 1 0 012 0z" />\n        </svg>\n        ',e.appendChild(s)}return{btn:a,wrapper:e,iframe:t}}buf2hex=e=>[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join(""),[...document.getElementsByClassName("lit-video-wrapper")].forEach((e=>{const{btn:t,wrapper:a,iframe:n}=manipulateWrapper(e);[t,a].forEach((e=>e.addEventListener("click",(()=>onClickedUnlock(n)))))}));
